<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>ADMIN PANEL | NGHƒ®A ELEMENTAL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@700&display=swap" rel="stylesheet">
    <style>
        body { background: #0f172a; font-family: 'Quicksand', sans-serif; color: white; }
        .admin-card { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 15px; }
        .btn-approve { background: #22c55e; transition: 0.3s; }
        .btn-approve:hover { background: #16a34a; transform: scale(1.05); }
    </style>
</head>
<body class="p-8">
    <div class="max-w-6xl mx-auto">
        <div class="flex justify-between items-center mb-8 border-b border-white/10 pb-5">
            <h1 class="text-3xl text-purple-400 uppercase tracking-widest">Qu·∫£n L√Ω ƒê∆°n H√†ng - Nghƒ©a</h1>
            <div class="text-right text-xs">
                <p>Tr·∫°ng th√°i h·ªá th·ªëng: <span class="text-green-400">ƒêang ho·∫°t ƒë·ªông</span></p>
                <button onclick="location.href='index.html'" class="text-blue-400 hover:underline">Quay v·ªÅ Shop</button>
            </div>
        </div>

        <div class="grid grid-cols-1 gap-6">
            <div class="admin-card p-6">
                <h2 class="text-xl text-yellow-400 mb-4 flex items-center">üí∞ ƒê∆†N N·∫†P BANK/MOMO (C·∫ßn duy·ªát)</h2>
                <div id="list-bank" class="space-y-3">
                    </div>
            </div>

            <div class="admin-card p-6">
                <h2 class="text-xl text-blue-400 mb-4 flex items-center">‚ö° ƒê∆†N MUA D·ªäCH V·ª§ (C·∫ßn l√†m)</h2>
                <div id="list-service" class="space-y-3">
                    </div>
            </div>
        </div>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('nghia_db')) || {};

        function renderAdmin() {
            let bankHtml = "";
            let serviceHtml = "";

            Object.keys(db).forEach(username => {
                db[username].h.forEach((item, index) => {
                    if (item.s === "Ch·ªù duy·ªát") {
                        // Ph√¢n lo·∫°i ƒë∆°n Bank
                        if (item.n.includes("Bank")) {
                            bankHtml += `
                                <div class="flex justify-between items-center bg-white/5 p-4 rounded-xl border border-white/10">
                                    <div>
                                        <p class="font-bold text-green-400">${username.toUpperCase()}</p>
                                        <p class="text-sm">B√°o bank: <span class="text-white">${Number(item.p).toLocaleString()}ƒë</span></p>
                                        <p class="text-[10px] text-gray-400">${item.t}</p>
                                    </div>
                                    <button onclick="approveBank('${username}', ${index}, ${item.p})" class="btn-approve px-6 py-2 rounded-lg font-bold text-sm">DUY·ªÜT +100% TI·ªÄN</button>
                                </div>`;
                        } 
                        // Ph√¢n lo·∫°i ƒë∆°n C√†y thu√™ / V·∫≠t ph·∫©m
                        else {
                            serviceHtml += `
                                <div class="bg-white/5 p-4 rounded-xl border border-white/10">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <p class="font-bold text-blue-400">${item.n}</p>
                                            <p class="text-xs text-gray-300">Kh√°ch: ${username} | Gi√°: ${Number(item.p).toLocaleString()}ƒë</p>
                                            <div class="mt-2 p-2 bg-black/40 rounded border border-dashed border-white/20">
                                                <p class="text-xs text-yellow-200">Th√¥ng tin kh√°ch g·ª≠i: <b class="text-white">${item.info || 'Kh√¥ng c√≥'}</b></p>
                                            </div>
                                        </div>
                                        <div class="flex gap-2">
                                            <button onclick="approveService('${username}', ${index})" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg font-bold text-xs">XONG ƒê∆†N</button>
                                            <button onclick="deleteOrder('${username}', ${index})" class="bg-red-500/20 text-red-500 px-4 py-2 rounded-lg font-bold text-xs">X√ìA</button>
                                        </div>
                                    </div>
                                </div>`;
                        }
                    }
                });
            });

            document.getElementById('list-bank').innerHTML = bankHtml || "<p class='text-gray-500 italic text-sm'>Kh√¥ng c√≥ y√™u c·∫ßu n·∫°p ti·ªÅn n√†o.</p>";
            document.getElementById('list-service').innerHTML = serviceHtml || "<p class='text-gray-500 italic text-sm'>Kh√¥ng c√≥ ƒë∆°n h√†ng n√†o c·∫ßn l√†m.</p>";
        }

        function approveBank(user, idx, amount) {
            if(!confirm(`C·ªông ${Number(amount).toLocaleString()}ƒë cho ${user}?`)) return;
            db[user].b += Number(amount); // C·ªông ƒë·ªß 100% ti·ªÅn
            db[user].h[idx].s = "Th√†nh c√¥ng";
            save();
            alert("ƒê√£ c·ªông ti·ªÅn th√†nh c√¥ng cho " + user);
            renderAdmin();
        }

        function approveService(user, idx) {
            db[user].h[idx].s = "ƒê√£ xong";
            save();
            alert("ƒê√£ duy·ªát ho√†n th√†nh ƒë∆°n h√†ng!");
            renderAdmin();
        }

        function deleteOrder(user, idx) {
            if(confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ƒë∆°n n√†y?")) {
                db[user].h.splice(idx, 1);
                save();
                renderAdmin();
            }
        }

        function save() {
            localStorage.setItem('nghia_db', JSON.stringify(db));
        }

        renderAdmin();
    </script>
</body>
</html>
