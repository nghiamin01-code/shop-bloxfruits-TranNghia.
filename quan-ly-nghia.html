<!DOCTYPE html>
<html>
<head>
    <title>ADMIN SHOP B·∫ÆP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
</head>
<body class="bg-gray-900 text-white p-5">
    <h1 class="text-2xl font-bold mb-5 text-yellow-400">QU·∫¢N L√ù ƒê∆†N H√ÄNG - SHOP B·∫ÆP</h1>

    <div class="grid grid-cols-1 gap-5">
        <div class="bg-gray-800 p-5 rounded-xl border border-yellow-500">
            <h2 class="font-bold mb-3 text-green-400 uppercase">üîî Y√™u c·∫ßu n·∫°p Bank (Duy·ªát tay)</h2>
            <div id="bank-list" class="space-y-2"></div>
        </div>

        <div class="bg-gray-800 p-5 rounded-xl border border-blue-500">
            <h2 class="font-bold mb-3 text-blue-400 uppercase">‚öîÔ∏è ƒê∆°n h√†ng c·∫ßn x·ª≠ l√Ω</h2>
            <div id="order-list" class="space-y-2"></div>
        </div>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://shop-blox-fruit-trannghia-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // L·∫•y danh s√°ch bank
        db.ref('requests').on('value', s => {
            const list = document.getElementById('bank-list');
            list.innerHTML = "";
            s.forEach(item => {
                const d = item.val();
                list.innerHTML += `<div class="bg-black/50 p-3 rounded flex justify-between">
                    <span>${d.user} - ${d.info}</span>
                    <button onclick="approveBank('${d.user}', '${item.key}')" class="bg-green-600 px-3 py-1 rounded text-xs">C·ªòNG TI·ªÄN + DUY·ªÜT</button>
                </div>`;
            });
        });

        async function approveBank(user, key) {
            const money = prompt("Nh·∫≠p s·ªë ti·ªÅn c·∫ßn c·ªông cho " + user + ":");
            if(money) {
                const s = await db.ref('users/' + user).get();
                const bal = s.val().balance || 0;
                await db.ref('users/' + user).update({ balance: parseInt(bal) + parseInt(money) });
                await db.ref('requests/' + key).remove();
                alert("ƒê√£ duy·ªát v√† c·ªông ti·ªÅn!");
            }
        }

        // L·∫•y danh s√°ch ƒë∆°n h√†ng
        db.ref('orders').on('value', s => {
            const list = document.getElementById('order-list');
            list.innerHTML = "";
            s.forEach(item => {
                const d = item.val();
                if(d.status === 'ƒêang x·ª≠ l√Ω') {
                    list.innerHTML += `<div class="bg-black/50 p-3 rounded flex justify-between">
                        <span>${d.user} mua ${d.item}</span>
                        <button onclick="db.ref('orders/${item.key}').update({status:'Ho√†n th√†nh'})" class="bg-blue-600 px-3 py-1 rounded text-xs">XONG ‚úÖ</button>
                    </div>`;
                }
            });
        });
    </script>
</body>
</html>
